% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/main.R
\name{add.MDS}
\alias{add.MDS}
\title{Perform MDS (multidimensional scaling) from a distance matrix on a Gene List and Store Results in scTypeEval object}
\usage{
add.MDS(
  scTypeEval,
  ident = NULL,
  sample = NULL,
  normalization.method = c("Log1p", "CLR", "pearson"),
  distance.method = "euclidean",
  gene.list = NULL,
  data.type = c("sc", "pseudobulk", "pseudobulk_1vsall", "GloScope"),
  min.samples = 5,
  min.cells = 10,
  black.list = NULL,
  ndim = 30,
  pca = FALSE,
  pca.dim = 30,
  ncores = 1,
  bparam = NULL,
  progressbar = TRUE,
  verbose = TRUE
)
}
\arguments{
\item{scTypeEval}{A \code{scTypeEval} object containing single-cell expression data.}

\item{ident}{Character. Metadata column name used to group cells (e.g., cell type annotation).
If \code{NULL}, the active identity from \code{scTypeEval} is used.}

\item{sample}{Character. Metadata column name specifying sample identity for pseudobulk analysis.
Required for \code{pseudobulk}, \code{pseudobulk_1vsall}, and \code{GloScope} data types.}

\item{normalization.method}{Character. Method for normalizing gene expression before PCA. See \link[scTypeEval]{add.HVG} for more details.
Options: \code{"Log1p"}, \code{"CLR"}, \code{"pearson"} (default: \code{"Log1p"}).}

\item{distance.method}{Character. Distance metric to use. Must be one of the predefined methods. Default: \code{"euclidean"}.}

\item{gene.list}{Named list of character vectors. Each element is a set of genes for PCA analysis.
If \code{NULL}, all pre-defined gene lists in \code{scTypeEval} are used recursively.}

\item{data.type}{Character. Type of data to analyze. Options: \code{"sc"}, \code{"pseudobulk"},
\code{"pseudobulk_1vsall"}, or \code{GloScope}. Default is \code{"sc"}.}

\item{min.samples}{Integer. Minimum number of samples required for pseudobulk PCA (default: 5).}

\item{min.cells}{Integer. Minimum number of cells required per group for PCA (default: 10).}

\item{black.list}{Character vector. Genes to exclude from PCA. If \code{NULL}, defaults to
the blacklist stored in \code{scTypeEval}.}

\item{ndim}{Integer. Number of maximum dimensions of the space represented (default: 30).}

\item{pca}{Logical. Whether to perform PCA before computing metrics. Default: \code{FALSE}. This parameter will be turned to \code{TRUE} for GloScope data.type.
\code{FALSE} will build distances directly on the genes within \code{gene.list}, while \code{TRUE} will do it on their principal components.}

\item{pca.dim}{Integer. Number of maximum dimensions to compute PCA, if distances are computed there (default: 30).}

\item{ncores}{Integer. Number of CPU cores to use for parallel processing. Default: \code{1}.}

\item{bparam}{Parallel backend parameter object for BiocParallel. If provided, overrides \code{ncores}.}

\item{progressbar}{Logical. Whether to display a progress bar during computation. Default: \code{FALSE}.}

\item{verbose}{Logical. Whether to print messages during execution. Default: \code{TRUE}.}
}
\value{
The modified \code{scTypeEval} object with MDS results stored in \code{reductions} slot.
}
\description{
This function projects your distance matrix into a lower-dimensional Euclidean space (typically 2D or 3D),
while preserving the pairwise distances as closely as possible, based on an specified gene list
and stores the results in the \code{reductions} slot of an scTypeEval object.
}
\examples{
\dontrun{
sceval <- add.MDS(sceval, # scTypeEval object
                 ident = "cell_type",
                 distance.method = "euclidean",
                 sample = "sample_id",
                 data.type = "pseudobulk")
}

}
\seealso{
\link{add.HVG} \link[stats]{cmdscale}
}
