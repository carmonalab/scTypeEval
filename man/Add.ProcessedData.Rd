% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/main.R
\name{Add.ProcessedData}
\alias{Add.ProcessedData}
\title{Add externally processed data to an scTypeEval object}
\usage{
Add.ProcessedData(
  scTypeEval,
  data,
  aggregation,
  ident = NULL,
  ident.name = "custom",
  sample = NULL,
  filter = FALSE,
  min.samples = 5,
  min.cells = 10,
  verbose = TRUE
)
}
\arguments{
\item{scTypeEval}{An \code{scTypeEval} object generated by \code{create.scTypeEval}.}

\item{data}{A count matrix (dense or sparse) containing processed expression values
(either single-cell or pseudobulk aggregated).}

\item{aggregation}{A string specifying the aggregation type. Must be one of the
supported: \code{"single-cell"} or \code{"pseudobulk"}.}

\item{ident}{A vector of cell identities corresponding to the columns of \code{data}.
Used to define grouping (e.g. cell type). Required.}

\item{ident.name}{A string specifying the name under which the provided \code{ident}
will be stored (default: \code{"custom"}).}

\item{sample}{A vector of sample identifiers corresponding to the columns of \code{data}.
Required unless already encoded in the object.}

\item{filter}{Logical indicating whether to filter the data based on \code{min.samples}
and \code{min.cells}. Only allowed when \code{aggregation = "single-cell"} (default: FALSE).}

\item{min.samples}{Minimum number of samples required to retain a feature (default: 5).}

\item{min.cells}{Minimum number of cells required to retain a feature (default: 10).}

\item{verbose}{Logical indicating whether to print progress messages (default: TRUE).}
}
\value{
An updated \code{scTypeEval} object containing:
\itemize{
\item \code{data}: A new \code{DataAssay} object stored under the specified aggregation type.
}
}
\description{
Adds a user-supplied processed dataset (e.g. single-cell or pseudobulk)
into an \code{scTypeEval} object as a \code{DataAssay}. Supports filtering and consistency checks
on cell type and sample annotations.
}
\details{
\itemize{
\item The function validates that identity and sample annotations match the dimensions of the input data.
\item For \code{aggregation = "single-cell"}, optional filtering removes groups with too few
samples or cells.
\item For \code{aggregation = "pseudobulk"}, the function checks that each (sample, identity)
pair occurs exactly once (i.e., fully aggregated).
\item Processed data is wrapped in a \code{DataAssay} object and added to the \code{scTypeEval}.
}
}
\examples{
\donttest{
library(Matrix)
counts <- Matrix(rpois(200, 5), nrow = 20, ncol = 10, sparse = TRUE)
rownames(counts) <- paste0("Gene", seq_len(20))
colnames(counts) <- paste0("Cell", seq_len(10))
metadata <- data.frame(
  celltype = rep(c("A", "B"), each = 5),
  sample = rep(paste0("S", 1:2), times = 5),
  row.names = colnames(counts)
)
sceval <- create.scTypeEval(matrix = counts, metadata = metadata)
sceval <- Add.ProcessedData(
  sceval,
  data = counts,
  aggregation = "single-cell",
  ident = metadata$celltype,
  sample = metadata$sample,
  filter = TRUE
)
}

}
\seealso{
\link{Run.ProcessingData}
}
