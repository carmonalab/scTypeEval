% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/main.R
\name{get.hierarchy}
\alias{get.hierarchy}
\title{Perform Hierarchical Clustering on scTypeEval Dissimilarity Matrices}
\usage{
get.hierarchy(
  scTypeEval,
  dissimilarity.slot = "all",
  hierarchy.method = "ward.D2",
  verbose = TRUE
)
}
\arguments{
\item{scTypeEval}{An \code{scTypeEval} object containing dissimilarity matrices in the \code{dissimilarity} slot.}

\item{dissimilarity.slot}{Character string. Specifies which dissimilarity assays to cluster.
Use \code{"all"} (default) to include all available assays.}

\item{hierarchy.method}{Character string specifying the hierarchical clustering method
(default: \code{"ward.D2"}). See \link[stats]{hclust} for available options.}

\item{verbose}{Logical. If \code{TRUE}, prints messages about progress (default: \code{TRUE}).}
}
\value{
A list of clustering results, one per dissimilarity assay. Each element
contains a contingency table of cluster assignments versus input labels.
}
\description{
This function performs hierarchical clustering using precomputed dissimilarity
matrices stored in the \code{dissimilarity} slot of an \code{scTypeEval} object.
Each dissimilarity assay is clustered independently using the specified hierarchical
clustering method.
}
\details{
For each dissimilarity assay, the function applies \link[stats]{hclust}
to the stored dissimilarity matrix. The number of clusters is set equal
to the number of unique identities provided in the assay metadata.
}
\examples{
# Create and process test data
library(Matrix)
counts <- Matrix(rpois(6000, 5), nrow = 100, ncol = 60, sparse = TRUE)
rownames(counts) <- paste0("Gene", 1:100)
colnames(counts) <- paste0("Cell", 1:60)

metadata <- data.frame(
  celltype = rep(c("TypeA", "TypeB"), each = 30),
  sample = rep(paste0("Sample", 1:6), times = 10),
  row.names = colnames(counts)
)

sceval <- create.scTypeEval(matrix = counts, metadata = metadata)
sceval <- Run.ProcessingData(sceval, ident = "celltype",
                             sample = "sample", min.samples = 3,
                             min.cells = 3, verbose = FALSE)
sceval <- Run.HVG(sceval,
                  var.method = "scran",
                  ngenes = 10,
                  verbose = FALSE)

# Compute Pseudobulk Euclidean dissimilarity
sceval <- Run.Dissimilarity(sceval, method = "Pseudobulk:Euclidean",
                            reduction = FALSE, verbose = FALSE)
# Perform hierarchical clustering on all available dissimilarity matrices
hier_results <- get.hierarchy(sceval, verbose = FALSE)

}
\seealso{
\link{Run.Dissimilarity}, \link[stats]{hclust}
}
