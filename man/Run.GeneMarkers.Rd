% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/main.R
\name{Run.GeneMarkers}
\alias{Run.GeneMarkers}
\title{Identify and add marker genes to an scTypeEval object}
\usage{
Run.GeneMarkers(
  scTypeEval,
  method = c("scran.findMarkers"),
  ngenes.celltype = 50,
  aggregation = "single-cell",
  black.list = NULL,
  ncores = 1,
  bparam = NULL,
  progressbar = FALSE,
  verbose = TRUE,
  ...
)
}
\arguments{
\item{scTypeEval}{An \code{scTypeEval} object containing normalized data in the
\code{"single-cell"} slot (see \code{Run.ProcessingData}).}

\item{method}{A character string specifying the marker gene identification
method. Currently supported:
\itemize{
\item \code{"scran.findMarkers"} — Uses \pkg{scran}'s
\link[scran]{findMarkers} for differential expression analysis.
}
Default: \code{"scran.findMarkers"}.}

\item{ngenes.celltype}{Integer specifying the max number of marker genes to retain
per cell type (default: \code{50}).}

\item{aggregation}{Method to group cells stored in \code{scTypeEval@data}, either \code{"single-cell"} or \code{"pseudobulk"}. Default is \code{"single-cell"}.}

\item{black.list}{A character vector of genes to exclude from marker selection.
If \code{NULL}, uses the object’s internal blacklist (\code{scTypeEval@black.list}).}

\item{ncores}{Integer specifying the number of cores to use for parallel
processing (default: \code{1}).}

\item{bparam}{Optional. A \code{BiocParallel} parameter object for controlling
parallel computation. If provided, overrides \code{ncores}.}

\item{progressbar}{Logical, whether to display a progress bar during computation
(default: \code{FALSE}).}

\item{verbose}{Logical, whether to print messages during execution (default: \code{TRUE}).}

\item{...}{Additional arguments passed to the underlying marker detection function.}
}
\value{
The modified \code{scTypeEval} object with marker genes added to
\code{scTypeEval@gene.lists[[method]]}.
}
\description{
Identifies cell type marker genes from normalized single-cell data
stored in an \code{scTypeEval} object. The identified markers are stored in the
\code{gene.lists} slot under the chosen method (e.g. \code{"scran.findMarkers"}).
}
\details{
\itemize{
\item Requires that normalized single-cell data has been generated with
\code{Run.ProcessingData}.
\item Both cell identities and sample annotations are automatically extracted
from the normalized data.
\item Genes present in the blacklist (\code{black.list}) are removed before marker selection.
\item For \code{"scran.findMarkers"}, the \pkg{scran} method \code{findMarkers} is applied
to identify differentially expressed genes per cell type while adjusting for sample effects.
}
}
\examples{
\dontrun{
# Create scTypeEval object and run preprocessing
sceval <- create.scTypeEval(seurat_obj)
sceval <- Run.ProcessingData(sceval)

# Identify marker genes per cell type
sceval <- Run.GeneMarkers(sceval, method = "scran.findMarkers", ngenes.celltype = 50)
}

}
\seealso{
\link{Run.ProcessingData}, \link{Add.ProcessedData}
}
