% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/main.R
\name{load_singleCell_object}
\alias{load_singleCell_object}
\title{Load a Single-Cell Object from File}
\usage{
load_singleCell_object(path, split = TRUE)
}
\arguments{
\item{path}{Character string. Path to the file to load.
Supported formats: \code{.rds} (Seurat or SingleCellExperiment objects)
and \code{.h5ad} (AnnData objects).}

\item{split}{Logical (default: \code{TRUE}).
If \code{TRUE}, returns a list with two elements:
\itemize{
\item \code{counts}: A sparse \code{dgCMatrix} of raw counts.
\item \code{metadata}: A \code{data.frame} of cell metadata.
}
If \code{FALSE}, returns the loaded object as-is
(Seurat, SingleCellExperiment, or AnnData).}
}
\value{
If \code{split = TRUE}, a list containing:
\itemize{
\item \code{counts} – sparse counts matrix
\item \code{metadata} – cell metadata
}
If \code{split = FALSE}, returns the loaded single-cell object directly.
}
\description{
Loads single-cell datasets from \code{.rds} or \code{.h5ad} files into R.
Supports \pkg{Seurat}, \pkg{SingleCellExperiment}, and \pkg{anndata} objects.
Depending on the input type and the \code{split} parameter, the function
either returns the original object or extracts and returns the
raw counts matrix and metadata.
}
\details{
\itemize{
\item \strong{\code{.rds} input}:
\itemize{
\item If the object is a \pkg{Seurat} object, the raw counts are extracted
from the "RNA" assay, and cell metadata is taken from \code{object@meta.data}.
\item If the object is a \pkg{SingleCellExperiment}, counts are extracted from
the \code{"counts"} assay, and cell metadata is taken from \code{colData(object)}.
\item Other \code{.rds} object types are not supported.
}
\item \strong{\code{.h5ad} input}:
Requires the \pkg{anndata} package. The \code{"counts"} layer must be present,
otherwise the function will stop with an error. Counts are transposed
to match R’s cell-by-gene convention.
}
}
\examples{
# Set a temporary location for temporary file
filepath <- file.path(tempdir(), "sce_test.rds")

# Create small SCE object with sparse matrix
counts <- Matrix::Matrix(rpois(1000, 5), nrow = 50, ncol = 20, sparse = TRUE)
rownames(counts) <- paste0("Gene", 1:50)
colnames(counts) <- paste0("Cell", 1:20)
sce_obj <- SingleCellExperiment::SingleCellExperiment(
   assays = list(counts = counts),
   colData = data.frame(
      cell_type = rep(c("TypeA", "TypeB"), each = 10),
      row.names = colnames(counts)
  )
)

saveRDS(sce_obj, filepath)

obj <- load_singleCell_object(filepath, split = TRUE)

}
