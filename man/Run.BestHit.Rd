% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/main.R
\name{Run.BestHit}
\alias{Run.BestHit}
\title{Perform Mutual Best Hit Consistency Evaluation}
\usage{
Run.BestHit(
  scTypeEval,
  ident = NULL,
  ident_GroundTruth = NULL,
  method = c("Mutual.Score", "Mutual.Match"),
  classifier = c("SingleR", "Spearman_correlation"),
  sample = NULL,
  data.type = "sc",
  gene.list = NULL,
  black.list = NULL,
  min.cells = 10,
  min.samples = 5,
  ncores = 1,
  bparam = NULL,
  progressbar = TRUE,
  verbose = TRUE
)
}
\arguments{
\item{scTypeEval}{An scTypeEval object containing single-cell expression data, metadata, and gene lists.}

\item{ident}{A character string specifying the metadata column containing the cell type
annotations. Default is \code{NULL}, which uses the active identity in \code{scTypeEval}.}

\item{ident_GroundTruth}{(Optional) A character string specifying the metadata column
containing the ground truth annotations. Default is \code{NULL}, meaning \code{ident} is used.}

\item{method}{A character vector specifying which Mutual Best Hit method(s) quantification to use.
Supported options, by default both are run if possible:
\itemize{
\item \code{"Mutual.Score"}: Computes the product of reciprocal prediction scores from classifier per cell type.
\item \code{"Mutual.Match"}: Calculates the normalized proportion of reciprocal matches.
between the two sample classifications per cell type. Only supported by \code{"pseudobulk"} data.type.
}}

\item{classifier}{Method to classify or annotated cell type. Supported option are:
\itemize{
\item \code{Spearman_correlation}: Assigns cell types by computing the Spearman correlation between each cell's expression profile and reference profiles (e.g., averaged marker gene expression per cell type). The label with the highest correlation is assigned.
\item \link[SingleR]{SingleR}: Automatic annotation method introduced by Aran et al., 2019 \link{\doi{10.1038/s41590-018-0276-y}}, implemented in \link[SingleR]{SingleR}. Compares each cell to reference datasets and assigns the most similar cell type label.
}}

\item{sample}{A character string specifying the metadata column that identifies sample IDs.
This is required for consistency evaluation.}

\item{data.type}{Character. Type of data input to perform.
Options, one of:
\itemize{
\item \code{"sc"}: Single-cell data, where each cell is treated as an individual observation.
It supports only \code{"Mutual.Score"} metric.
\item \code{"pseudobulk"}: Aggregated expression values per cell type and sample, useful to capture inter-sample variability.
It supports \code{"Mutual.Score"} and \code{"Mutual.Match"} metrics.
}}

\item{gene.list}{(Optional) A named list of gene sets to use for Mutual Best Hit consistency evaluation.
If \code{NULL}, the function uses recursively precomputed gene lists from \code{scTypeEval}.}

\item{black.list}{Character vector. Genes to exclude from consistency analysis. Defaults to \code{scTypeEval@black.list}.}

\item{min.cells}{An integer specifying the minimum number of cells required per cell type.
Default is \code{10}.}

\item{min.samples}{An integer specifying the minimum number of samples required per cell type.
Default is \code{5}.}

\item{ncores}{Integer. Number of CPU cores to use for parallel processing. Default: \code{1}.}

\item{bparam}{Parallel backend parameter object for BiocParallel. If provided, overrides \code{ncores}.}

\item{progressbar}{Logical. Whether to display a progress bar during computation. Default: \code{TRUE}.}

\item{verbose}{Logical. Whether to print messages during execution. Default: \code{TRUE}.}
}
\value{
An updated \code{scTypeEval} object containing the consistency evaluation results.
The results are stored in \code{scTypeEval@consistency} and can be accessed per gene list.
}
\description{
This function evaluates the consistency of cell type annotations across multiple samples
using a Mutual Best Hit approach. It applies a classifier bidirectionally between
sample pairs to assess inter-sample reciprocal similarity.
}
\details{
This function uses a classifier to assess inter-sample reciprocal similarity, results are stored
within \code{scTypeEval} \code{consistency} slot.
}
\examples{
\dontrun{
sceval <- Run.BestHit(scTypeEval = sceval, 
                      ident = "cell_type", 
                      sample = "sample_id", 
                      data.type = "pseudobulk", 
                      ncores = 4)
}

}
