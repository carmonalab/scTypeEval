% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/main.R
\name{Run.PCA}
\alias{Run.PCA}
\title{Perform PCA on Processed Data and Store Results in scTypeEval Object}
\usage{
Run.PCA(
  scTypeEval,
  gene.list = NULL,
  black.list = NULL,
  ndim = 30,
  verbose = TRUE
)
}
\arguments{
\item{scTypeEval}{A \code{scTypeEval} object containing processed expression data. See \code{Run.ProcessingData} or \code{Add.ProcessedData}).}

\item{gene.list}{Named list of character vectors. Each element defines a gene set for PCA analysis.
If \code{NULL}, all pre-defined gene lists stored in \code{scTypeEval} are used.}

\item{black.list}{Character vector of genes to exclude from PCA. If \code{NULL},
the blacklist stored in \code{scTypeEval} is used.}

\item{ndim}{Integer. Number of principal components to compute (default: 30).}

\item{verbose}{Logical. Whether to print progress messages during computation (default: \code{TRUE}).}
}
\value{
The modified \code{scTypeEval} object with PCA results stored in the
\code{reductions} slot for each processed data aggregation.
}
\description{
This function computes Principal Component Analysis (PCA) for each processed
data aggregation stored in the \code{scTypeEval} object (e.g., single-cell or pseudobulk).
The resulting PCA embeddings and loadings are stored in the \code{reductions} slot of the object.
}
\details{
This function runs PCA on all processed data slots within the \code{scTypeEval} object.
Each PCA result is stored as a \code{DimRed} assay containing:
\itemize{
\item \code{embeddings}: PCA coordinates of samples/cells.
\item \code{feature.loadings}: Loadings of features (genes) on each PC.
\item \code{gene.list}: The gene sets used for PCA.
\item \code{black.list}: The genes excluded from PCA.
\item \code{aggregation}: The aggregation type (e.g., \code{"single-cell"}, \code{"pseudobulk"}).
\item \code{ident}, \code{sample}, and \code{group}: Metadata carried over from processed data.
}
}
\examples{
# Create and process test data
library(Matrix)
counts <- Matrix(rpois(6000, 5), nrow = 100, ncol = 60, sparse = TRUE)
rownames(counts) <- paste0("Gene", 1:100)
colnames(counts) <- paste0("Cell", 1:60)

metadata <- data.frame(
  celltype = rep(c("TypeA", "TypeB"), each = 30),
  sample = rep(paste0("Sample", 1:6), times = 10),
  row.names = colnames(counts)
)

sceval <- create.scTypeEval(matrix = counts, metadata = metadata)
sceval <- Run.ProcessingData(sceval, ident = "celltype", 
                             aggregation = "pseudobulk",
                             sample = "sample", min.samples = 3,
                             min.cells = 3, verbose = FALSE)
sceval <- Run.HVG(sceval, aggregation = "pseudobulk", var.method = "scran", verbose = FALSE)

# Run PCA on HVG genes
sceval <- Run.PCA(sceval, gene.list = "HVG", ndim = 5, verbose = FALSE)

}
\seealso{
\link{Add.ProcessedData}
}
