% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/main.R
\name{plot.Heatmap}
\alias{plot.Heatmap}
\title{Plot Heatmaps of Dissimilarity Matrices}
\usage{
\method{plot}{Heatmap}(
  scTypeEval,
  dissimilarity.slot = "all",
  sort.similarity = NULL,
  sort.consistency = NULL,
  low.color = "black",
  high.color = "white",
  hclust.method = "ward.D2",
  verbose = TRUE,
  ...
)
}
\arguments{
\item{scTypeEval}{An \code{scTypeEval} object containing one or more dissimilarity assays.}

\item{dissimilarity.slot}{Character string specifying which dissimilarity assay(s)
to plot. If \code{"all"}, all available dissimilarity assays are included (default: \code{"all"}).}

\item{sort.similarity}{Optional. Character string naming a dissimilarity assay to use
for ordering cells by similarity (hierarchical clustering within each cell type).}

\item{sort.consistency}{Optional. Character string specifying a consistency metric
(passed to \code{get.Consistency()}) for ordering cell types by overall consistency.}

\item{low.color}{Color for the low end of the heatmap gradient (default: \code{"black"}).}

\item{high.color}{Color for the low end of the heatmap gradient (default: \code{"white"}).}

\item{hclust.method}{Clustering method to use when \code{sort.similarity} is provided
(default: \code{"ward.D2"}).}

\item{verbose}{Logical. Whether to print progress and diagnostic messages (default: \code{TRUE}).}

\item{...}{Additional arguments passed to \code{get.Consistency()}.}
}
\value{
A named list of \code{ggplot2} objects, one per dissimilarity assay.
If only a single assay is selected, the corresponding heatmap plot is returned directly.
}
\description{
Visualize dissimilarity matrices stored in an \code{scTypeEval} object as annotated
heatmaps. Each selected dissimilarity assay is shown as a heatmap where rows and
columns represenent cell type and sample, ordered by cell type and optionally sorted by similarity
or consistency metrics. Group boundaries are marked to highlight cell-type consistency.
}
\details{
Ordering logic:
\itemize{
\item If both \code{sort.similarity} and \code{sort.consistency} are \code{NULL}, cell types are
ordered alphabetically, and cells within each type are ordered alphabetically.
\item If only \code{sort.consistency} is provided, cell types are ordered by the
selected consistency metric, and cells within each type are ordered alphabetically.
\item If only \code{sort.similarity} is provided, cell types are ordered by hierarchical
clustering of average similarities, and cells within each type are clustered.
\item If both are provided, cell types are ordered by consistency, while cells
within each type are ordered by similarity clustering.
}

Each heatmap is rendered with ggplot2, with group boundaries and axis labels
indicating cell-type structure.
}
\examples{
\dontrun{
# Plot heatmaps for all dissimilarity assays
hm_all <- plot.Heatmap(sceval)

# Plot with cell types ordered by consistency
hm_cons <- plot.Heatmap(sceval, sort.consistency = "silhouette")

# Plot with cells clustered by similarity within cell type
hm_sim <- plot.Heatmap(sceval, sort.similarity = "WasserStein")

# Plot with consistency ordering of cell types and similarity ordering within
hm_both <- plot.Heatmap(sceval, sort.consistency = "silhouette", sort.similarity = "WasserStein")
}

}
\seealso{
\link{Run.dissimilarity}, \link[stats]{hclust}, \link{get.Consistency}
}
