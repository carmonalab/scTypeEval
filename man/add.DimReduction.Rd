% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/main.R
\name{add.DimReduction}
\alias{add.DimReduction}
\title{Add a Custom Dimensionality Reduction to an scTypeEval Object}
\usage{
add.DimReduction(
  scTypeEval,
  embeddings,
  aggregation,
  ident = NULL,
  ident.name = "custom",
  sample = NULL,
  key = NULL,
  gene.list = NULL,
  black.list = NULL,
  feature.loadings = NULL,
  filter = FALSE,
  min.samples = 5,
  min.cells = 10,
  verbose = TRUE
)
}
\arguments{
\item{scTypeEval}{A \code{scTypeEval} object where the dimensionality reduction will be stored.}

\item{embeddings}{A numeric matrix of dimension-reduced embeddings (cells/samples x components).}

\item{aggregation}{Character. Aggregation level of the embeddings. Options:
\code{"single-cell"} (no aggregation) or \code{"pseudobulk"} (aggregated per sample and cell type).}

\item{ident}{Required. A vector of cell identities (e.g., cell type annotation).
If \code{NULL}, the function attempts to infer it.}

\item{ident.name}{Character. Name assigned to the provided \code{ident} grouping (default: \code{"custom"}).}

\item{sample}{Required. A vector indicating sample identity of each observation.
If \code{NULL}, the function attempts to infer it.}

\item{key}{Optional. Character. Key or label assigned to this dimensionality reduction (e.g., \code{"PCA"}, \code{"UMAP"}).}

\item{gene.list}{Optional. Character vector or named list of genes associated with the embeddings
(e.g., input features used for the dimensionality reduction). Default: \code{NULL}.}

\item{black.list}{Optional. Character vector of genes excluded from the dimensionality reduction.
Default: \code{NULL}.}

\item{feature.loadings}{Optional. Matrix of feature loadings corresponding to the embeddings
(e.g., PCA rotation matrix). Default: \code{NULL}.}

\item{filter}{Logical. If \code{TRUE}, filters cells before adding the embeddings based on
\code{min.samples} and \code{min.cells}. Only supported for \code{"single-cell"} aggregation.
Default: \code{FALSE}.}

\item{min.samples}{Integer. Minimum number of samples required for retaining a cell type in
single-cell filtering. Default: \code{5}.}

\item{min.cells}{Integer. Minimum number of cells required per group for filtering. Default: \code{10}.}

\item{verbose}{Logical. Whether to print messages during execution. Default: \code{TRUE}.}
}
\value{
The modified \code{scTypeEval} object with the new dimensionality reduction stored
in the \code{reductions} slot.
}
\description{
This function allows the user to insert pre-computed dimensionality reduction (e.g., PCA, UMAP,
t-SNE, or any embedding) into an \code{scTypeEval} object. The embeddings are stored in the
\code{reductions} slot as a \code{DimRed} object, enabling integration with the scTypeEval
workflow for downstream analysis.
}
\examples{
\donttest{
# Add precomputed PCA embeddings into scTypeEval
sceval <- add.DimReduction(
   scTypeEval = sceval,
   embeddings = my_pca_matrix,
   aggregation = "single-cell",
   ident = celltype_annotation,
   sample = sample_id,
   key = "PCA"
)
}

}
\seealso{
\link{Run.PCA}
}
