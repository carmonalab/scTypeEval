% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/main.R
\name{Run.Dissimilarity}
\alias{Run.Dissimilarity}
\title{Run Dissimilarity Analysis}
\usage{
Run.Dissimilarity(
  scTypeEval,
  method = "WasserStein",
  reduction = TRUE,
  gene.list = NULL,
  black.list = NULL,
  ReciprocalClassifier = "SingleR",
  ncores = 1,
  bparam = NULL,
  progressbar = FALSE,
  verbose = TRUE
)
}
\arguments{
\item{scTypeEval}{A \code{scTypeEval} object containing processed data
and/or dimensional reduction assays.}

\item{method}{Character. Dissimilarity method to use. Must be one of
\code{names(dissimilarity_methods)}. Default is \code{"WasserStein"}.}

\item{reduction}{Logical. Whether to compute dissimilarity on dimensional
reduction embeddings (if available). Default is \code{TRUE}.}

\item{gene.list}{Optional. Character vector of genes to include. If
\code{NULL}, the method will use the default or inherited gene list.}

\item{black.list}{Optional. Character vector of genes to exclude. If
\code{NULL}, the method will use the default or inherited blacklist.}

\item{ReciprocalClassifier}{Character. Classifier to use for RecipClassif
dissimilarity methods. Default is
\code{"SingleR"}.}

\item{ncores}{Integer. Number of cores for parallelization. Default is \code{1}.}

\item{bparam}{Optional. BiocParallel parameter object to control
parallelization. Default is \code{NULL}.}

\item{progressbar}{Logical. Whether to display a progress bar during
computation. Default is \code{FALSE}.}

\item{verbose}{Logical. Whether to print progress messages. Default is \code{TRUE}.}
}
\value{
An updated \code{scTypeEval} object with a new \code{DissimilarityAssay}
stored in \code{scTypeEval@dissimilarity[[method]]}.
}
\description{
Computes dissimilarity between cell populations or pseudobulk profiles
stored in a \code{scTypeEval} object, using one of the supported methods.
Dissimilarity can be computed either on dimensional reduction embeddings
(if available) or on processed gene expression data.
}
\details{
The function supports multiple dissimilarity strategies:
\itemize{
\item \code{"Pseudobulk:<distance>"} – computes pairwise distances between
pseudobulk profiles using the specified distance metric. Supported distances are euclidean, cosine, and pearson.
\item \code{"WasserStein"} – computes Wasserstein distances between groups
of embeddings or cells.
\item \code{"RecipClassif:<method>"} – assigns cells pairwise between samples using
the specified classifier, then computes dissimilarity between assignments.
Supported methods are 'match' and 'score'.
}

If \code{reduction = TRUE}, the function expects that dimensional reduction
embeddings have been added previously via \code{Run.PCA()} or
\code{add.DimReduction()}. If unavailable, set \code{reduction = FALSE}
to compute dissimilarity on processed expression data instead.
}
\examples{
\dontrun{
# Run Wasserstein dissimilarity on dimensional reduction embeddings
scTypeEval <- Run.Dissimilarity(scTypeEval,
                               method = "WasserStein",
                               reduction = TRUE)

# Run pseudobulk Euclidean dissimilarity on processed data
scTypeEval <- Run.Dissimilarity(scTypeEval, 
                                method = "Pseudobulk:euclidean", 
                                reduction = FALSE)
                                
# Run RecipClassif classification-based dissimilarity with SingleR
scTypeEval <- Run.Dissimilarity(scTypeEval, 
                                method = "RecipClassif:Match", 
                                ReciprocalClassifier = "SingleR")
}

}
\seealso{
\code{\link{add.DimReduction}}, \code{\link{Run.PCA}},
\code{\link{Run.ProcessingData}}
}
