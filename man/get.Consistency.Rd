% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/main.R
\name{get.Consistency}
\alias{get.Consistency}
\title{Compute Consistency of Cell Type Annotations Across samples}
\usage{
get.Consistency(
  scTypeEval,
  dissimilarity.slot = "all",
  Consistency.metric = c("silhouette", "2label.silhouette", "NeighborhoodPurity",
    "ward.PropMatch", "Orbital.medoid", "Average.similarity"),
  KNNGraph_k = 5,
  hclust.method = "ward.D2",
  normalize = FALSE,
  return.scTypeEval = FALSE,
  verbose = TRUE
)
}
\arguments{
\item{scTypeEval}{A \code{scTypeEval} object containing one or more
dissimilarity assays (see \code{Run.Dissimilarity}).}

\item{dissimilarity.slot}{Character. Which dissimilarity assay(s) to use.
Can be \code{"all"} (default) or the name(s) of specific slots stored
in \code{scTypeEval@dissimilarity}.}

\item{Consistency.metric}{Character vector. Internal validation metrics to compute.
Supported options include:
\itemize{
\item \code{"silhouette"} – cohesion/separation score
\item \code{"2label.silhouette"} – Variant of the silhouette score where,
for each cell, the within-cluster distance is compared against the average
distance to all cells outside its cluster (rather than just the closest
other cluster). This effectively treats the clustering as a two-group
problem: "own cell type" vs. "all others." Scores are then averaged per
cell type. Higher values indicate stronger separation of a cell type
from the rest of the dataset as a whole.
\item \code{"NeighborhoodPurity"} – For each cell, computes the fraction of its K nearest
neighbors that belong to the same cell type. Scores are then averaged per cell type.
Optionally, values can be normalized relative to the expected proportion by chance.
Higher scores indicate that cells are surrounded by neighbors of the same type,
reflecting strong local label consistency.
\item \code{"ward.PropMatch"} – For each true cell type, identifies the cluster that contains
the largest number of its cells (the dominant cluster) and computes the proportion of cells
from that cell type that fall into this cluster. Optionally, this proportion can be normalized
relative to the expected proportion by chance. Higher values indicate better alignment between
true labels and cluster assignments.
\item \code{"Orbital.medoid"} – For each cell type, identifies a representative medoid cell
(the cell minimizing the total distance to all other cells of the same type).
Then, for each non-medoid cell, it checks whether the cell is closer to its own medoid
than to the medoids of other cell types. The metric for each cell type is the proportion
of cells that are closer to their own medoid than to any other medoid.
Optionally, this proportion can be normalized relative to the expected proportion by chance.
Higher values indicate that cells are well-clustered around their medoid.
\item \code{"Average.similarity"} – Measures how similar cells are within
the same cell type relative to cells of other types. For each cell,
it computes the average distance to other cells in its group and to
cells outside its group, then combines these into a normalized score (higher = better).
Scores are then averaged per cell type. This metric is similar in spirit to a one-label silhouette.
}
Default: all supported metrics.}

\item{KNNGraph_k}{Integer. Number of nearest neighbors to use for
graph-based metrics (e.g. \code{"NeighborhoodPurity"}). Default is \code{5}.}

\item{hclust.method}{Character. Agglomeration method passed to \code{\link{hclust}}
for Ward-based metrics. Default is \code{"ward.D2"}.}

\item{normalize}{Logical. Whether to normalize metric values (e.g., scaling
across dissimilarity methods). Default is \code{FALSE}.}

\item{return.scTypeEval}{Logical. Whether to return data frame with inter-sample consistencies or store within scTypeEval@consistency slot. Default is \code{FALSE}.}

\item{verbose}{Logical. Whether to print progress messages. Default is \code{TRUE}.}
}
\value{
A \code{data.frame} with the following columns:
\itemize{
\item \code{celltype} – the annotation/group label
\item \code{measure} – numeric consistency score
\item \code{consistency.metric} – the metric name
\item \code{dissimilarity_method} – the dissimilarity method used
\item \code{ident} – the identity class (from \code{scTypeEval@ident})
}
}
\description{
Computes internal validation metrics (consistency measures) for cell type
annotations based on dissimilarity assays stored in a \code{scTypeEval} object.
For each dissimilarity representation, one or more internal validation metrics
are calculated per cell type and returned in a tidy \code{data.frame}.
}
\details{
This function builds upon the dissimilarity assays generated by
\code{\link{Run.Dissimilarity}}. For each selected dissimilarity representation,
the chosen internal validation metrics are computed and stored in a long-format
data frame, allowing downstream comparison across cell types, metrics,
and dissimilarity methods.
}
\examples{
\dontrun{
# Compute silhouette and Neighborhood Purity consistency metrics
consistency_df <- get.Consistency(scTypeEval,
                                  dissimilarity.slot = "WasserStein",
                                  Consistency.metric = c("silhouette", "NeighborhoodPurity"))

# Run all metrics on all available dissimilarity slots
consistency_df <- get.Consistency(scTypeEval, dissimilarity.slot = "all")
}

}
\seealso{
\code{\link{Run.Dissimilarity}}
}
